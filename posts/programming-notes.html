<!doctype html>
<html lang="en">

<head>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>zmc.space | Note to Self</title>
  <meta name="description" content="General Notes About the Solutions I Have to Problems">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Note to Self">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://zmc.space/posts/programming-notes">
  <meta property="og:description" content="General Notes About the Solutions I Have to Problems">
  <meta property="og:site_name" content="zmc.space">
  <meta property="og:image" content="http://zmc.space/assets/og-image.jpg">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="http://zmc.space/posts/programming-notes">
  <meta name="twitter:title" content="Note to Self">
  <meta name="twitter:description" content="General Notes About the Solutions I Have to Problems">
  <meta name="twitter:image" content="http://zmc.space/assets/og-image.jpg">

  <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
  <link href="http://zmc.space/feed.xml" type="application/rss+xml" rel="alternate" title="zmc.space Last 10 blog posts" />

  

  
    <link rel="stylesheet" href="/assets/light.css">

  
</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav appear">
  <a href="/" class="header-logo" title="zmc.space">zmc.space</a>
  <ul class="header-links">
    
    
      <li>
        <a href="https://twitter.com/Furkanzmc" rel="noreferrer noopener" target="_blank" title="Twitter">
          <span class="icon icon-twitter"></span>
        </a>
      </li>
    
    
    
      <li>
        <a href="https://github.com/Furkanzmc" rel="noreferrer noopener" target="_blank" title="GitHub">
          <span class="icon icon-github"></span>
        </a>
      </li>
    
    
    
    
    
    
    
  </ul>
</nav>

        <article class="article appear">
          <header class="article-header">
            <h1>Note to Self</h1>
            <p>General Notes About the Solutions I Have to Problems</p>
            <div class="article-list-footer">
              <span class="article-list-date">
                July 18, 2017
              </span>
              <span class="article-list-divider">-</span>
              <span class="article-list-minutes">
                
                
                  4 minute read
                
              </span>
              <span class="article-list-divider">-</span>
              <div class="article-list-tags">
                
                  <a href="/tag/general">general</a>
                
                  <a href="/tag/programming">programming</a>
                
              </div>
            </div>
          </header>

          <div class="article-content">
            <h1 id="problem-1---android-exclude-files-from-build-in-gradle">Problem 1 - Android: Exclude Files From Build in Gradle</h1>

<p>I recently added Firebase messaging support to <a href="https://github.com/Furkanzmc/qutils">qutils</a>. But I had no idea how to exclude the Firebase related files when I’m not using Firebase on my project. I finally figured it out.</p>

<p>I could exclude them by using the following code in <code class="highlighter-rouge">build.gradle</code> file.</p>

<figure class="highlight"><pre><code class="language-gradle" data-lang="gradle"><span class="n">java</span> <span class="o">{</span>
    <span class="n">exclude</span> <span class="s2">"**/notification/QutilsFirebase**"</span>
<span class="o">}</span></code></pre></figure>

<h1 id="problem-2---qml-how-to-disable-qml-file-caching">Problem 2 - QML: How to Disable QML File Caching</h1>

<p>You just need to put the following code before <code class="highlighter-rouge">QApplication</code> in your <code class="highlighter-rouge">main.cpp</code> file.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">qputenv</span><span class="p">(</span><span class="s">"QML_DISABLE_DISK_CACHE"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">);</span></code></pre></figure>

<h1 id="problem-3---qml-texts-fontsizemode-property-doesnt-work">Problem 3 - QML: Text’s fontSizeMode Property Doesn’t Work</h1>

<p>I’ve encountered with this recently. I was setting the <code class="highlighter-rouge">fontSizeMode: Text.HorizontalFit</code> but the text was seamingly the same size and was the drawn text was overflowing from the container. But when I set <code class="highlighter-rouge">elide: Text.ElideRight</code>, it worked perfectly. When I checked with the documentation nothing caught my eye at first but I read it again and I found the following:</p>

<blockquote>
  <p>The font size of fitted text has a minimum bound specified by the minimumPointSize or minimumPixelSize property and maximum bound specified by either the font.pointSize or font.pixelSize properties.</p>
</blockquote>

<p>This meant that the size of the text cannot be smaller than the <code class="highlighter-rouge">minimumPixelSize</code> or <code class="highlighter-rouge">minimumPointSize</code>, in my case they were high enough that setting the <code class="highlighter-rouge">fontSizeMode</code> did not make any difference. Let’s read on:</p>

<blockquote>
  <p>If the text does not fit within the item bounds with the minimum font size the text will be elided as per the elide property.</p>
</blockquote>

<p>And I did not have the <code class="highlighter-rouge">elide</code> property set. So I wasn’t seeing the effects. After lowering the <code class="highlighter-rouge">minimumPixelSize</code> and adding in the <code class="highlighter-rouge">elide</code> property, things worked as expected.</p>

<p>Here’s a poorly designed visual to help you understand it better.</p>

<p><img src="https://drive.google.com/uc?export=download&amp;id=0B2b4SnYRu-h_ZUN1dFl4S3BvRkk" alt="image" /></p>

<h1 id="problem-4---qml-handle-the-focus-in-an-app-with-swipeview-and-stackview">Problem 4 - QML: Handle the Focus In an App With SwipeView and StackView</h1>

<p>I’ve had this problem using the <code class="highlighter-rouge">NativeUtils</code> in my library <a href="https://github.com/Furkanzmc/qutils">qutils</a>. Here’s the general type of app you develop: You have a top <code class="highlighter-rouge">StackView</code> along with a menu bar. Each item in the <code class="highlighter-rouge">StackView</code> has its own navigation system.</p>

<figure class="highlight"><pre><code class="language-qml" data-lang="qml"><span class="kt">Item</span> <span class="p">{</span>
    <span class="nl">id</span><span class="p">:</span> <span class="nx">root</span>

    <span class="kt">SwipeView</span> <span class="p">{</span>
        <span class="nl">id</span><span class="p">:</span> <span class="nx">swipeView</span>

        <span class="kt">ViewOne</span> <span class="p">{</span> <span class="p">}</span>

        <span class="kt">ViewTwo</span> <span class="p">{</span> <span class="p">}</span>

        <span class="kt">ViewThree</span> <span class="p">{</span> <span class="p">}</span>

        <span class="kt">ViewFour</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">MenuBar</span> <span class="p">{</span>
        <span class="nl">id</span><span class="p">:</span> <span class="nx">menubar</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>And in each view, you have a <code class="highlighter-rouge">StackView</code> for navigation.</p>

<figure class="highlight"><pre><code class="language-qml" data-lang="qml"><span class="kt">Item</span> <span class="p">{</span>
    <span class="nl">id</span><span class="p">:</span> <span class="nx">root</span>

    <span class="kt">NavigationBar</span> <span class="p">{</span>
        <span class="nl">id</span><span class="p">:</span> <span class="nx">navBar</span>
    <span class="p">}</span>

    <span class="kt">NavigationStack</span> <span class="p">{</span>
        <span class="nl">id</span><span class="p">:</span> <span class="nx">navStack</span>
        <span class="nl">initialItem</span><span class="p">:</span> <span class="nx">cmp</span>
    <span class="p">}</span>

    <span class="kt">Component</span> <span class="p">{</span>
        <span class="nl">id</span><span class="p">:</span> <span class="nx">cmp</span>

        <span class="kt">InnerViewOne</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>And here’s <code class="highlighter-rouge">InnerViewOne</code>.</p>

<figure class="highlight"><pre><code class="language-qml" data-lang="qml"><span class="kt">NavigationPage</span> <span class="p">{</span>
    <span class="nl">id</span><span class="p">:</span> <span class="nx">root</span>

    <span class="kt">NativeUtils</span> <span class="p">{</span>
        <span class="nl">buttonEventsEnabled</span><span class="p">:</span> <span class="kc">true</span>
        <span class="nl">onBackButtonPressed</span><span class="p">:</span> <span class="p">{</span>
            <span class="nx">root</span><span class="p">.</span><span class="nx">navigationStack</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Now, all four of those views are initialized. When you are in <code class="highlighter-rouge">ViewOne</code> you need to be able to tell that the focus is in this view even though the other items are also created. Now, when the <code class="highlighter-rouge">currentIndex</code> of <code class="highlighter-rouge">SwipeView</code> changes the focus property of the current item is set automatically. So when <code class="highlighter-rouge">currentIndex</code> is 0, <code class="highlighter-rouge">ViewOne</code>’s <code class="highlighter-rouge">focus</code> property will be true. Here’s where the problem starts, within <code class="highlighter-rouge">ViewOne</code> you also have a <code class="highlighter-rouge">StackView</code> and that <code class="highlighter-rouge">StackView</code> can contain multiple items. And those items are where the real logic happens. So, If you are on Android and want to pop the stack you need to hook to the back button event and also need to know that <code class="highlighter-rouge">InnerViewOne</code> is the main visible item, that menu bar is not showing another view.</p>

<p>Since <code class="highlighter-rouge">buttonEventsEnabled</code> is set to true, this instance will receive the events no matter the focus of the <code class="highlighter-rouge">NavigationPage</code>. To solve the problem, you need to make use of the <code class="highlighter-rouge">FocusScope</code> and bind to its focus property with the <code class="highlighter-rouge">NavigationStack</code>. And whenever the <code class="highlighter-rouge">focus</code> property of the <code class="highlighter-rouge">NavigationStack</code> changes, you need to get the last item in the stack and change its focus too.</p>

          </div>

          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=Note+to+Self - http://zmc.space/posts/programming-notes by @Furkanzmc" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://zmc.space/posts/programming-notes" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
            <a href="https://plus.google.com/share?url=http://zmc.space/posts/programming-notes" title="Share on Google+" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 128 128"><path d="M40.7 55.9v16.1c0 0 15.6 0 22 0C59.2 82.5 53.8 88.2 40.7 88.2c-13.3 0-23.7-10.8-23.7-24.2s10.4-24.2 23.7-24.2c7.1 0 11.6 2.5 15.8 5.9 3.3-3.3 3.1-3.8 11.6-11.9 -7.2-6.6-16.8-10.6-27.4-10.6C18.2 23.3 0 41.5 0 64c0 22.5 18.2 40.7 40.7 40.7 33.6 0 41.8-29.3 39-48.8H40.7zM113.9 56.7V42.6h-10.1v14.1H89.4v10.1h14.5v14.5h10.1V66.8H128V56.7H113.9z"/></svg>
            </a>
          </div>

          
            <div id="disqus_thread" class="article-comments"></div>
            <script src="https://zmcspace.disqus.com/embed.js" async defer></script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
          
        </article>
        <footer class="footer appear">
  <p>
    <a href="/about" title="About me">Furkan Üzümcü</a>
  </p>
</footer>

      </div>
    </div>
  </main>
  
  <script>
    window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
    ga('create','UA-71841354-1','auto');ga('send','pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>


<script src="/assets/vendor.js"></script>



  <script src="/assets/webfonts.js"></script>




  <script src="/assets/scrollappear.js"></script>



<script src="/assets/application.js"></script>


</body>
</html>
